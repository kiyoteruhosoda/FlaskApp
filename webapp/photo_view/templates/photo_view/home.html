{% extends 'base.html' %}
{% block title %}Photo View{% endblock %}
{% block content %}
<h1>Photo View Home</h1>

<div class="mb-3">
  <button id="btn-import-start" class="btn btn-secondary">{{ _('Start Import') }}</button>
</div>
<div id="import-status" class="mt-3"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  let pickerSessionId = {{ picker_session_id|tojson }};
  const importBtn = document.getElementById('btn-import-start');
  const statusEl = document.getElementById('import-status');

  importBtn.addEventListener('click', async () => {
    if (!pickerSessionId) {
      return;
    }
    try {
      const resp = await fetch(`/api/picker/session/${pickerSessionId}/import`, {method: 'POST'});
      if (!resp.ok) {
        alert('Failed to start import');
        return;
      }
      statusEl.textContent = '{{ _("start import") }}';
    } catch (err) {
      console.error(err);
      alert('Failed to start import');
    }
  });
});
</script>
{% endblock %}
